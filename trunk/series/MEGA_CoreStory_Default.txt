%%
%% *CS_ThanksForRescue Content
%%
%% The PC has rescued the NPC. Hooray.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The one who was rescued
%%

Content
	name <Rescued an Ally>
	desc <The PC has just rescued an ally, who will suggest that he go speak with another member of the faction.>
	requires <*CS_ThanksForRescue 1:Ally>

	% E1 is the character who's been rescued
	% E2 is a public scene in this city, to be used as home scene if a
	%    pre-existing E4 can't be found.
	% E3 is another character allied with E2
	element2 <Scene Public !Okay -3 Building !Near -7>
	element3 <Character !Comrade 1 !Near 2 Neverfail>
	NeverFail3 <Mecha Pilot>

	% P1 = Initialization Counter
	start <if= PlotStatus %id% else %pop% ifNPCDead %1% LoseComp 0 .%id%_loss>
	.%id%_loss <+T-->

requires <*CS_ThanksForRescue>
element3 <Character !Near 2>

	sub
		Persona 1
		% V1 = Can only get reward once
		Greeting <if= PlotStatus %id% else %pop% goto .%id%_GoThanks>
		*.%id%_GoThanks <*ThanksForRescue .%id%_GoReward>
		.%id%_GoReward <if= V%id%01 0 else .%id%_GoBriefing V= %id%01 1 CashPrize Reward Threat StoryDL 100 200 NewChat Say %id%01 AddChat %id%01 AddChat %id%02>
		.%id%_GoBriefing <ifNPCOK %3% else .%id%_GoE3Dead NewChat Say %id%02 StoryNote %id%03 &SetTargetChar %3%  WinComp NPCScene %3% .%id%_changes>
		.%id%_changes <+Tgt +Fmi>
		.%id%_GoE3Dead <NewChat Say %id%05 SMemo 0 WinComp 0 .%id%_changes2>
		result%id%01 <Goto .%id%_GoBriefing>
		result%id%02 <if= ChatNPCFac PCFac else .%id%_GoR2Reject if# PCFac 0 else .%id%_GoR2Reject NewChat Say %id%04 AddChat %id%03>
		*.%id%_GoR2Reject <*RejectMission .%id%_GoR2Exit>
		.%id%_GoR2Exit <WinComp 0 .%id%_changes2>
		.%id%_changes2 <+T-- +F-->
		result%id%03 <Goto .%id%_GoBriefing>
		Msg%id%01 <Here's a reward for your quick thinking. This matter needs to be dealt with quickly, before it gets out of hand. We could use someone like you on our side.>
		Msg%id%02 <Go speak with %name3% at \Scene NPCScene %3% . I think \SPR %3% 'll have a mission you can help with.>
		Msg%id%03 <%name1% sent you to speak with %name3% at \SCENE NPCScene %3% .>
		Msg%id%04 <This is now official \FACTION ChatNPCFac business. All your other missions can wait; this is top priority.>
		Msg%id%05 <With %name3% dead, all our operatives will have to be extra careful. Stay on your toes for the next little while.>
		Prompt%id%01 <Tell me what you need.>
		Prompt%id%02 <Forget it, I'm finished here.>
		Prompt%id%03 <Understood. Tell me what I have to do.>
		Prompt%id%03_1 <Yeah, I'll be a good little quest-bitch...>
		CPrompt%id%03_1 <ifPCPassionate ifPCMelancholy Accept>
	end


Content
	name <Thanks for the Help>
	desc <The PC has rescued someone, who now wants to join the lance.>
	requires <*CS_ThanksForRescue -1:Ally -1:Enemy ~+Glo>

	%% E1 is the NPC that the PC rescued
	%% E2 is a nice scene for a date
	element2 <Scene !Near -7 Building Public Meeting>

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% LoseComp 0 .loss>
	.loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% Goto .%id%_GoStart>
		*.%id%_GoStart <*ThanksForRescue .%id%_GoOffer>
		.%id%_GoOffer <PCFriend %1% ifG React 30 else .%id%_GoNoOffer ifG PCCharm 10 else .%id%_GoNoOffer NewChat Say %id%01 AddChat %id%01 AddChat %id%02 AddChat %id%03>
		.%id%_GoNoOffer <ifChatNPCSexy else .%id%_GoCashAward ifFlirtation SkillTar StoryDL else .%id%_GoCashAward ifG React d10 else .%id%_GoCashAward NewChat Say %id%08 AddChat %id%06 AddChat %id%07>
		.%id%_GoCashAward <NewChat Say %id%07  StoryNote %id%05 CashPrize Reward Threat StoryDL 150 100 WinComp 0 .next>
		result%id%01 <NewChat Say %id%02 StoryNote %id%03 PCAlly %1% WinComp 0 .next>
		.next <+T-- +F-->
		result%id%02 <NewChat Say %id%04 StoryNote %id%05 CashPrize Reward Threat StoryDL 150 100 WinComp 0 .next>
		result%id%03 <NewChat Say %id%06 AddChat %id%04 AddChat %id%05>
		result%id%04 <Goto result%id%01>
		result%id%05 <Goto result%id%02>
		result%id%06 <NewChat Say %id%09 StoryNote %id%010 &SetTargetChar %1% WinComp %2% .%id%_date>
		.%id%_date <+Tda +F-->
		result%id%07 <Goto result%id%02>
		Msg%id%01 <I thought that to repay you for saving my life, I could join your team and maybe help out. What do you think?>
		Msg%id%02 <Thanks! I won't let you down!>
		Msg%id%03 <%name1% joined your lance in thanks for saving \PPR %1% life.>
		Msg%id%04 <I understand. Well, the least I can do is give you some money. Thanks for your help. I won't forget it.>
		Msg%id%05 <%name1% rewarded you for saving \PPR %1% life.>
		Msg%id%06 <I know, but... I have other talents that could be useful. And you could teach me to fight. Can't I come along with you, please?>
		Msg%id%07 <In thanks for saving my life, I'd like you to have this money.>
		Msg%id%08 <In thanks for saving my life, I'd like... honestly, I'd like to go out with you sometime.>
		Msg%id%09 <Great! Meet me in %name2% later on.>
		Msg%id%010 <After saving \PPR %1% life, %name1% invited you to %name2% for a date.>
		Prompt%id%01 <I think it's a good idea.>
		Prompt%id%01_1 <I'd be honored to have you join me.>
		Prompt%id%02 <No thanks. I don't need any help.>
		Prompt%id%02_1 <Sorry, I'm not looking for another lancemate.>
		Prompt%id%03 <Thanks, but aren't you a bit useless?>
		CPrompt%id%03 <if= NPCSkill E2 10 0 Accept>
		Prompt%id%03_1 <Thanks, but you aren't much of a fighter.>
		Prompt%id%04 <Alright. You can join me.>
		Prompt%id%05 <I don't have time to look after you.>
		Prompt%id%06 <I'd like that too.>
		Prompt%id%07 <This isn't a good time for that.>
	end

%% *CS_Duel Content
%%
%%
%% The PC is about to duel somebody as part of the core story.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%% This component should move the opponent from its current location to the
%% contest location at update, and then move the opponent back to its
%% original location at the end of the battle.
%%
%% Param1: The Challenger
%% Param2: The Challenger's home scene, for the purpose of this component
%% Param3: The outdoor scene where the duel will take place
%%
%% NEEDED SCRIPTS: To deal with the ending, the parent plot must define two
%% scripts:
%% 	.%id%_%plotid%_GoWin
%% 	.%id%_%plotid%_GoLose
%% %id% is the ID of the duel layer; so, if it was generated as subplot 1,
%% the calling plot would use %id1%.
%% Please note that it is possible this component will not exit to either of
%% the above labels, if a complete derailment of the story takes place.


Content
	name <A Duel Interrupted>
	Size 8
	desc <When you go to fight, you find some other mecha there.>
	requires <*CS_Duel (+P--|+Pme) ~F:-- ~T:Ally ~T:Friend -L:Enemy ~+Gpe>

	% E1 is the challenger
	% E2 is the challenger's home scene
	% E3 is the outdoor scene where the duel will take place
	% E4 is the faction whose mecha are present
	% E5 is the faction of the current city
	% E6 is the duel scene itself
	element4 <Faction Military !Enemy -7 !Xclude 1>
	% The faction of the root scene must not be an enemy of the character
	% you're dueling...
	element5 <Faction !Comrade -7 !Okay 1>
	Element6 <Prefab>
	Place6 <%e3%>

	% P%id%01 = Initialization Counter
	% P%id%02 = Duel target skill level calculator

	update <if=  P%id%01 0  P= %id%01 1  MoveNPC %1% %6%  SetNPCTeam %1% 3  V= %id%02 StoryDL  V+ %id%02 d5  NPCLevel %1% V%id%02>

	sub
		MetaScene 6 2
		% L1 = Encounter Over Counter
		% L2 = Initialization Counter
		% L4 = Identity of enemy NPC
		MapWidth 30
		MapHeight 30

		special <ARENA>

		Start <if= L2 0 L= 2 1   ForceChat %1%   AlterContext .change L= 4 %1%>
		nu1 <if= T1 0  Return   if= L1 0 L= 1 1   StoryNote 1   Trigger0 .%id%_%plotid%_GoLose>
		nu2 <if= T2 0           if= L1 0 L= 1 2   StoryNote 1   AddRenown 1  XPV 100   SALVAGE  ifTeamNotHostile 3 else GoFoughtNPC   Trigger0 .%id%_%plotid%_GoWin>
		GoFoughtNPC <WinComp 0 .Next>
		.next <+T-- +F-->
		.change <+Pun>

		end <ifNPCOK %1% MoveNPC %1% %2%>

		Msg1 <Your duel with %name1% was interrupted by %name4%.>

		sub
			team 1
			SetEnemy 2
			ParaX 5
			ParaY 10

			team 2
			SetEnemy 1 3
			Deploy <SetSelfFaction %4%   WMecha 2 Threat StoryDL 200>
			ParaX 15
			ParaY 25

			team 3
			SetEnemy 2
			ParaX 25
			ParaY 10
		end

		Persona 1
		% V%id%01 = Have spoken already
		greeting <if= PlotStatus %id% else %pop% if= V%id%01 1 else .%id%_GoFirstTime EndChat Say %id%01>
		.%id%_GoFirstTime <ifChatNPCInPlay else .%id%_GoWaiting EndChat Say %id%02 AddChat %id%01 AddChat %id%02 AddChat %id%03 V= %id%01 1>
		*.%id%_GoWaiting <*WaitingForDuel %3%>
		result%id%01 <EndChat Say %id%03 AddHeroic 1        PCFriend %1% &SetAllyFac %5% &SetEnemyFac %4% PCFEnemy %4%>
		result%id%02 <EndChat Say %id%04 AddEasygoing -10   AddHeroic -1  PCEnemy %1%  TeamAttack 3 if= &EnemyFac 0 &SetEnemyFac %4% PCFEnemy %4%>
		result%id%03 <EndChat Say %id%05 AddRenown -1 AddReact -d20 if= &EnemyFac 0 &SetEnemyFac %4% PCFEnemy %4%>
		Msg%id%01 <Keep your mind on the game.>
		Msg%id%02 <It looks like we're not alone... those mecha are from %name4%. They can't possibly be up to any good. How about we fight them together?>
		Msg%id%02_1 <As much as I'd like to fight you, I'm afraid that we just got something bigger to worry about... Those mecha are from %name4%. Obviously they're here on some kind of covert mission. We should stop them before they do any damage.>
		CMsg%id%02_1 <ifNPCSociable Accept>
		Msg%id%02_2 <Look at that... a raiding party from %name4%. Let's defeat them together.>
		CMsg%id%02_2 <ifNPCShy Accept>
		Msg%id%02_3 <Sorry to interrupt our duel, but there's a group of mecha from %name4% right here. Most likey they're planning something destructive. Shall we defeat them together?>
		CMsg%id%02_3 <ifNPCEasygoing Accept>
		Msg%id%02_4 <Our fight will have to wait, there's something more important to take care of first... Look, it's a scout team from %name4%. This could be bad. If we team up we should be able to defeat them easily.>
		CMsg%id%02_4 <ifNPCPassionate Accept>
		Msg%id%02_5 <I was hoping our duel would be interesting, but I just found something a whole lot more fun. My sensors picked up a raiding party from %name4%. If we join forces, they won't stand a chance against us.>
		CMsg%id%02_5 <ifNPCCheerful Accept>
		Msg%id%02_6 <I've got some bad news... Look over there, those mecha were sent by %name4%. Is this the start of an invasion? Let's put our duel aside and defeat them before they have a chance to kill anyone.>
		CMsg%id%02_6 <ifNPCMelancholy Accept>
		Msg%id%03 <You're an honorable pilot, \PC . Let's do this.>
		Msg%id%03_1 <It'll be a pleasure to fight by your side. Let's go.>
		Msg%id%04 <Your hatred means so much that you'd side with the enemies of \NARRATIVE 7 ? Then let's see who can kill you first, %name4% or me...>
		Msg%id%04_1 <How spiteful are you? These mecha are here to destroy \NARRATIVE 7 , and still you can't think of anything but our fued. If it's a fight you want then it's a fight you're going to get!>
		Msg%id%05 <You're just going to run? You coward! Do the lives of your fellow citizens mean nothing to you?>
		Msg%id%05_1 <You're going to leave me to face them all by myself!? Coward! Traitor!>
		Prompt%id%01 <I'll help you, for \NARRATIVE 7 's sake.>
		Prompt%id%01_1 <It's up to us to protect \NARRATIVE 7 .>
		Prompt%id%02 <No way, you aren't getting off that easy.>
		CPrompt%id%02 <ifNPCArchEnemy E2 Accept>
		Prompt%id%02_1 <Forget it. I hate you more than %name4%.>
		Prompt%id%03 <You do it yourself. I'm out of here.>
		Prompt%id%03_1 <You can fight them, I'm getting out of here.>
	end
	inv
		STC ENCOUNTER-DUEL
		name <%name1%'s Mecha>
		update <if= PlotStatus %id% else GoHide ShowEncounter SetStat STAT_MetaVisibility 0  Goto GoSetOrders>
	end


Content
	name <Regular Duel>
	desc <The PC and the NPC will fight. Nothing special happens.>
	requires <*CS_Duel>
	Size 5

	% E1 is the challenger
	% E2 is the challenger's home scene
	% E3 is the outdoor scene where the duel will take place
	% E4 is the duel encounter
	Element4 <Prefab>
	Place4 <%e3%>

	% P%id%01 = Initialization Counter
	update <if= PlotStatus %id% else %pop% if= P%id%01 0 MoveNPC %1% %4% SetNPCTeam %1% 2 NPCLevel %1% StoryDL P= %id%01 1>

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop%  ifChatNPCInPlay else .%id%_GoNotInPlay Goto .%id%_GoChallenge>
		*.%id%_GoChallenge <*ArenaChallenge .%id%_GoThemeInfo>
		*.%id%_GoThemeInfo <*THEME_EXPO&Enemy NA>
		*.%id%_GoNotInPlay <*WaitingForDuel %3%>

		MetaScene 4 2
		% L1 = Encounter Over Counter
		% L2 = Initialization Counter
		% L4 = Identity of enemy NPC
		MapWidth 30
		MapHeight 30

		special <ARENA>

		Start <if= L2 0 L= 2 1   ForceChat %1%>
		nu1 <if= T1 0  Return   MoveNPC %1% %2%  if= L1 0 L= 1 1   SMemo 1   History 4  Print 2   Trigger0 .%id%_%plotid%_GoLose>
		nu2 <if= T2 0           MoveNPC %1% %2%  if= L1 0 L= 1 2   SMemo 3   History 5  Print 2 AddRenown 1   XPV 100   Trigger0 .%id%_%plotid%_GoWin>

		Msg1 <You were defeated by %name1% in a duel; \SPR %1% is waiting for you at %name2%.>
		Msg2 <%name1% returns to %name2%.>
		Msg3 <You defeated %name1% in a duel; \SPR %1% is waiting for you at %name2%.>
		Msg4 <You were defeated by %name1% in a duel.>
		Msg5 <You defeated %name1% in a duel.>

		sub
			team 1
			SetEnemy 2
			ParaX 5
			ParaY 5

			team 2
			SetEnemy 1
			ParaX 25
			ParaY 25
		end

	end
	inv
		STC ENCOUNTER-DUEL
		name <%name1%'s Mecha>
		update <if= PlotStatus %id% else GoHide ShowEncounter SetStat STAT_MetaVisibility 0  Goto GoSetOrders>
	end

%%
%% *CS_Win_UnexpectedMeeting Content
%%	&Rescue		The PC rescued the NPC
%%
%% During the last mission, the PC met someone. The mission giver will now probably
%% tell the PC to go look for that person, or something.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Mission-giver
%% Param2: The NPC who was met
%%

Content
	name <Find out what he knows>
	desc <The PC is asked to locate the previously met NPC, and find out what he knows.>
	requires <*CS_Win_UnexpectedMeeting>

	% E1 is the mission-giver.
	% E2 is the NPC previously met

	start <if= PlotStatus %id% else %pop% ifNPCDead %1%  SMemo 0 WinComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% NewChat Say %id%01 AddChat %id%01 AddChat %id%02>
		.%id%_win <+Tlt +Fin>
		.%id%_meh <+T-- +F-->
		result%id%01 <ifNPCOK %2% else .%id%_GoTargetDead NewChat Say %id%02 &SetTargetChar %2% WinComp 0 .%id%_win CashPrize Reward Threat StoryDL 100 200 AddReact d10 SMemo %id%04>
		.%id%_GoTargetDead <NewChat Say %id%03 SMemo 0 WinComp 0 .%id%_meh CashPrize Threat StoryDL 100 300>
		result%id%02 <NewChat Say %id%05 SMemo 0 WinComp 0 .%id%_meh CashPrize Threat StoryDL 100 150 AddSociable -d10>
		Msg%id%01 <Welcome back, \PC . How did the mission go?>
		Msg%id%01_1 <What's the progress on the mission I assigned to you? Do you have anything to report?>
		Msg%id%01_2 <Did you complete the mission I assigned to you? I've been waiting for your report.>
		Msg%id%02 <%name2% might know something about our enemy. You should try to find \OPR %2% and see what you can learn.>
		Msg%id%02_1 <Interesting. %name2% might have some useful information. You should try to find \OPR %2% and see what you can learn.>
		Msg%id%03 <I'm sure that's not important. Here's your reward for completing the mission.>
		Msg%id%04 <You should seek %name2% to find out what \SPR %2% knows.>
		Msg%id%05 <I see. Here's your reward, then.>
		Msg%id%05_1 <I knew you wouldn't have any problem. Here's a reward for your efforts.>
		CMsg%id%05_1 <ifG React 40 Accept>
		Msg%id%05_2 <I find that hard to believe... but as long as the job has been done, here's your reward.>
		CMsg%id%05_2 <ifG 10 React Accept>
		Prompt%id%01 <I met someone named %name2%.>
		Prompt%id%01_1 <During the mission I met %name2%.>
		Prompt%id%02 <It was completed without incident.>
		Prompt%id%02_1 <There's nothing special to report.>
	end

%%
%% *CS_Loss_UnexpectedMeeting Content
%%
%% During the last mission, the PC met someone. Unfortunately that person apparently
%% died or something.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Mission-giver
%% Param2: The NPC who was met
%%

Content
	name <Too bad we couldn't find that pilot...>
	desc <The mission-giver laments the loss of E2.>
	requires <*CS_Loss_UnexpectedMeeting>

	% E1 is the mission-giver.
	% E2 is the NPC who was lost

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% LoseComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop%  NewChat Say %id%01 AddChat %id%01  AddChat %id%02>

		.%id%_GoEnd <SMemo 0  LoseComp 0 .%id%_loss>
		.%id%_loss <+T-- +F-->
		.%id%_GoContinue <SMemo %id%05  &SetTargetChar %2% LoseComp 0 .%id%_find>
		.%id%_find <+Tlt +Fin>

		result%id%01 <ifNPCDead %2% else .%id%_GoE2Find NewChat Say %id%02 Goto .%id%_GoEnd>
		.%id%_GoE2Find <NewChat Say %id%03  Goto .%id%_GoContinue>
		*result%id%02 <*MissionWasFailure .%id%_GoR2Finish &AllyFac &EnemyFac>
		.%id%_GoR2Finish <AddSociable -d8  Goto .%id%_GoEnd>

		Msg%id%01 <I understand that things didn't go well on the mission.>
		Msg%id%02 <Whatever information %name2% might have had is now gone as well...>
		Msg%id%03 <Reports indicate that %name2% is still out there; if you could find \OPR %2% , maybe \SPR %2% could give us some useful information.>

		Msg%id%05 <You should seek %name2% to find out what \SPR %2% knows.>
		Prompt%id%01 <I couldn't save %name2%.>
		Prompt%id%01_1 <I failed; %name2% was lost.>
		Prompt%id%02 <I don't want to talk about it.>
		Prompt%id%02_1 <You don't want to know.>
	end

%%
%% *CS_Win_ToUnknownEnemy Content
%%
%% The PC has won a mission and the plot state has changed to +Pun.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Mission-giver
%%

Content
	name <Here, have some money>
	desc <The NPC will pay the PC for the job.>
	requires <*CS_Win_ToUnknownEnemy>

	% E1 is the NPC.

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% SMemo 0 WinComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% gOTO .%id%_GoReportSuccess>
		*.%id%_GoReportSuccess <*MissionWasSuccess&Reward .%id%_GoEnd &AllyFac &EnemyFac>
		.%id%_GoEnd <CashPrize Reward Threat StoryDL 100 500 SMemo 0 WinComp 0 .%id%_win>
		.%id%_win <+T-- +F-->
	end

%%
%% *CS_Loss_ToUnknownEnemy Content
%%
%% Catch-all lose mission component.
%% The PC has lost a mission provided by the NPC.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Mission-giver
%%

Content
	name <Default Loss>
	desc <The NPC will debrief the PC on the loss.>
	requires <*CS_Loss_ToUnknownEnemy>

	% E1 is the NPC.

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% LoseComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% NewChat Say %id%01 SMemo 0 LoseComp 0 .%id%_loss>
		.%id%_loss <+T-- +F-->
		Msg%id%01 <You have failed in the mission. Unless we can learn what our enemy is after, we have no chance of success.>
		Msg%id%01_1 <We have lost, and even worse we don't know the purpose behind these attacks.>
		CMsg%id%01_1 <ifNPCSociable Accept>
		Msg%id%01_2 <You lost the mission. Our enemy moves in secret, but soon all will be revealed.>
		CMsg%id%01_2 <ifNPCShy Accept>
		Msg%id%01_3 <That last mission didn't go so well. It'd be a lot easier to deal with these attacks if we knew what they were after.>
		CMsg%id%01_3 <ifNPCEasygoing Accept>
		Msg%id%01_4 <You failed. There must be some purpose behind the attacks, but until we figure it out we are forced to play sitting ducks.>
		CMsg%id%01_4 <ifNPCPassionate Accept>
		Msg%id%01_5 <Too bad about that last mission, but don't let it get you down. We have to keep our guard up. There's no telling when another attack could come.>
		CMsg%id%01_5 <ifNPCCheerful Accept>
		Msg%id%01_6 <Your mission was a complete failure. This is madness... how are we supposed to defend ourselves, when we don't even know what the enemy is after?>
		CMsg%id%01_6 <ifNPCMelancholy Accept>
		Msg%id%01_10 <We have to learn what \FACTION &EnemyFac is up to. It seems like that's the only chance we have to stop them.>
		CMsg%id%01_10 <ifFactionExists &EnemyFac Accept>
		Msg%id%01_20 <It's clear now that \PERSONA &EnemyChar has some reason for these attacks, but what could it be?>
		CMsg%id%01_20 <ifNPCOK &EnemyChar Accept>
	end


%%
%% *CS_CAWinMission Content
%%	&RevealEF	The enemy faction has been revealed
%%
%% Catch-all win mission component.
%% The PC has won a mission provided by the NPC. Note that the mission should not
%% have altered the state of the story; therefore, this reward is free to do so
%% itself.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Mission-giver
%%

Content
	name <Here, have some money>
	desc <The NPC will pay the PC for the job.>
	requires <*CS_CAWinMission>

	% E1 is the NPC.

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% SMemo 0 WinComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% gOTO .%id%_GoReportSuccess>
		*.%id%_GoReportSuccess <*MissionWasSuccess&Reward .%id%_GoEnd &AllyFac &EnemyFac>
		.%id%_GoEnd <CashPrize Reward Threat StoryDL 100 500 SMemo 0 WinComp 0 .%id%_win>
		.%id%_win <+T-- +F-->
	end

%%
%% *CS_CALoseMission Content
%%	&RevealEF	The enemy faction has been revealed
%%
%% Catch-all lose mission component.
%% The PC has lost a mission provided by the NPC. Note that the mission should not
%% have altered the state of the story; therefore, this reward is free to do so
%% itself.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Mission-giver
%%

Content
	name <Default Loss>
	desc <The NPC will debrief the PC on the loss.>
	requires <*CS_CALoseMission>

	% E1 is the NPC.

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% LoseComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% gOTO .%id%_GoReportLoss>
		*.%id%_GoReportLoss <*MissionWasFailure .%id%_GoEnd &AllyFac &EnemyFac>
		.%id%_GoEnd <SMemo 0 LoseComp 0 .%id%_loss>
		.%id%_loss <+T-- +F-->
	end


%%
%% *CS_WinDuelVs Content
%%
%%
%% The PC has won a duel against the NPC.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Challenger
%%

Content
	name <You should go see MILIT...>
	desc <The NPC will reccomend that the PC go ask someone about a job.>
	requires <*CS_WinDuelVs>

	% E1 is the NPC.
	% E2 is the person to see about the job
	% E3 is a public scene for the meeting.
	Element2 <Character "MILIT" !Near -7 !Ally -7 !Okay -3>
	Element3 <Scene Building Public !Okay 2>

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% SMemo 0 WinComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% ifNPCOK %2% else .%id%_GoE2Died NewChat Say %id%01 SMemo %id%02 &SetTargetChar %2% WinComp %3% .%id%_win>
		.%id%_GoE2Died <NewChat Say %id%03 SMemo 0 WinComp 0 .%id%_draw>
		.%id%_win <+Tgt +Fmi>
		.%id%_draw <+T-- +F-->
		Msg%id%01 <You beat me. You should go talk with %name2% in %name3%; I hear that \SPR %2% 's looking for a good pilot.>
		Msg%id%02 <%name1% reccomended that you go ask %name2% in %name3% for a mission.>
		Msg%id%03 <You won the duel. Congratulations.>
	end

%%
%% *CS_LoseDuelVs Content
%%
%%
%% The PC has lost a duel against the NPC.
%%
%% The parent plot sets the plot status to this layer's ID when ready.
%%
%% Param1: The Challenger
%%

Content
	name <Ha ha!>
	desc <The NPC will just chide the PC, then end the plot.>
	requires <*CS_LoseDuelVs>

	% E1 is the NPC.

	start <if= PlotStatus %id% else %pop% ifNPCDead %1% SMemo 0 LoseComp 0 .%id%_loss>
	.%id%_loss <+T-- +F-->

	sub
		Persona 1
		greeting <if= PlotStatus %id% else %pop% NewChat Say %id%01 SMemo 0 LoseComp 0 .%id%_changes>
		.%id%_changes <+T-- +F-->
		Msg%id%01 <You lost the duel. Good for me.>
	end
