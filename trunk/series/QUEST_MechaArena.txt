%%
%% Mecha Arena Quest Components
%%

%%
%% *:MECHA_ARENA_BASE
%%	Contains the arena manager
%%
%%	Set QuestStatus when manager admits PC to arena; end the quest after the PC has
%%	completed the championship.
%%

Content
	name <Mullins Arena>
	requires <*:MECHA_ARENA_BASE>

	% E1 is Mullins
	% E2 is the arena
	% E3 is the entrance to the arena
	Element1 <Prefab>
	Scene1 <Building Public Sleazy>
	Team1 <Citizens>
	TeamData1 <Pass Ally>

	Scene2 <New *Arena>

	Element3 <Prefab>
	Scene3 <Environs>

	sub
		Persona 1
		rumor0 <Mullins used to be one of the greatest privateers, but had to retire when she was crippled in battle.>
		greeting <if# QuestStatus %qid% 0 else GoPreQuest if= ArenaState %2% NAV_AS_Win else GoCheckLoss Goto GoArenaWin>
		GoCheckLoss <if= ArenaState %2% NAV_AS_Loss else GoCheckReady Goto GoArenaLoss>
		GoCheckReady <if= ArenaState %2% NAV_AS_Vacant else GoArenaFull ifG ComTime ArenaRecharge %2% else GoArenaBusy Goto GoOfferFight>

		GoArenaWin <if= ArenaWins %2% 10 else GoMinorWin Goto GoBigWin>
		*GoMinorWin <*BasicArenaWin %2% GoResetArena>
		*GoArenaLoss <*BasicArenaLoss %2% GoResetArena>
		GoResetArena <ResetArena %2%>

		*GoArenaFull <*ArenaIsFull %2%>
		*GoArenaBusy <*ArenaIsBusy %2%>

		*GoChooseBattle <*StartArenaBattle %2% GoStartFight>
		GoStartFight <SavePos PrepArena %2% 100 >
		*GoRefuseBattle <*RefuseArenaFight %2%>

		GoPreQuest <NewChat Say 1 Goto GoStartQuest>
		GoStartQuest <SetQuestStatus %qid% %id% SetArenaThreat %2% 10>

		GoOfferFight <>
		GoBigWin <>



		Msg1 <This is a test. Come talk to me again to check the mainline arena code.>

	end
	inv
		NPC Mercenary
		name <Mullins>
		% Mullins is Miaga's mother. She was a hero in the privateer fleet
		% until being horribly injured in the line of duty. The left half
		% of Mullins's body is mostly cybernetic.
		mecha <>
		statline 13 10 14 16 8 17 10 13
		CharDesc Female Heroic Criminal Sociable Melancholy Renowned
		% Age 45; since basic char age is 20, add +25.
		Age 25
		%% Mullins is a member of the Pro Duelist Association
		SetFaction 5
		EquipChar 25000
		SDL_PORTRAIT <por_f_mullins(O-Y).png>
		SDL_SPRITE <cha_f_bandit.png>
		SDL_COLORS <200 200 0 142 62 39 1 75 67>

		STC QUEST-MAPMARKER-AUTO-STATIONARY
		name <Privateer's Arena>
		desig <ENTRANCE %s2%>
	end
