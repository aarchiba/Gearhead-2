%% Scene prototypes for set adventure content.

%% These scenes can use variables + messages 1 through 10-
%% vars/msgs 11 through 99 are reserved for
%% use by the quest that generated them.

%%
%% *CityBlock Content
%%
%% Contains a mecha-scale city block

Scene 0 2
	name <# District>
	requires <*CityBlock>
	MegaCityMap
	MapWidth 30
	MapHeight 30

	sub
		Team 1
		SetEnemy 2
		ParaX 5
		ParaY 5

		Team 2
		name <Citizens>
		Passive
		ParaX 25
		ParaY 25
	end


%%
%% *RobotFactory Content
%%
%% Contains a factory with killer robots. Not expanded as a dungeon.

Scene
	name <# Factory>
	requires <*RobotFactory>
	special <NOEXIT>
	type <factory>
	mapwidth 30
	mapheight 30
	MonkeyMap
	IndustrialTiles
	LockedDoorChance 15
	SecretDoorChance 20

	NeededCells 3

	start <Print 1>
	msg1 <You enter \SCENE SceneID .>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monster>
		type <Robot>
		SetEnemy 1
		Stat 2 1

		room
		width 3
		height 3
		sub
			StairsUp
			Destination -1
		end
	end


%%
%% *HideOut Content
%%		&MonkeyMap	Must be a monkeymap
%%		&BoxMap		Must be a boxmap
%%
%%  Hideouts will be constructed as a bigbox or a monkeymap, so plan
%%  your rooms appropriately.

Scene
	name <#'s Hideout>
	requires <*HideOut -&BoxMap>
	type <Private Complex>
	special <NOEXIT>
	MonkeyMap

	quest_entrance <*ENT_Hideout>

	MapWidth 28
	MapHeight 28

	NeededCells 2
	content <Fill Sub *HIDEOUT_X na>

	Start <Print 1>
	Msg1 <You enter \SCENE SceneID .>

	sub
		Team 1

		Team 2
		name <Citizens>

		Team 3
		name <Guards>
		SetAlly 2

		Room
		minimap <......###..#1#...........>
		sub
			Elevator
			Destination -1
			MiniMapComponent 1
		end
	end

Scene
	name <#'s Hideout>
	requires <*HideOut -&MonkeyMap>
	type <Private Complex>
	special <NOEXIT>
	BoxMap

	quest_entrance <*ENT_Hideout>

	MapWidth 12
	MapHeight 17

	NeededCells 2
	content <Fill Sub *HIDEOUT_X na>

	Start <Print 1>
	Msg1 <You enter \SCENE SceneID .>

	sub
		Team 1

		Team 2
		name <Citizens>

		Team 3
		name <Guards>
		SetAlly 2

		Room
		minimap <......###..#1#...........>
		sub
			Elevator
			Destination -1
			MiniMapComponent 1
		end
	end


%%
%% *CargoHold Content
%%

Scene
	name <# Hold>
	requires <*CargoHold>
	type <Private>
	special <NOEXIT>
	BoxMap
	IndustrialTiles

	MapWidth 22
	MapHeight 32

	NeededCells 2
	content <Fill Sub *STORAGE_X na>

	Start <Print 1>
	Msg1 <You enter the cargo hold.>

	sub
		Team 1

		Team 2
		name <Citizens>
		SetAlly 1

		Team 3
		name <Guards>
		SetAlly 2

		Room
		minimap <......###..#1#...........>
		sub
			Elevator
			Destination -1
			MiniMapComponent 1
		end
	end


%%
%%  *ItemCrypt Content
%%
%% A location for a lost item. Note that I use "Crypt" here in the "cryptic" sense.
%% It's a place where an item is locked away. Recovering the item from this spot
%% should not require thievery or anything underhanded, though that may make the job
%% easier depending on circumstances.
%%
%% Most of these scenes will require an entrance quest of some kind. The key item
%% will almost definitely be an artifact of some kind.

Scene
	name <the # Wreck>
	requires <*ItemCrypt Spinner>
	special <NOEXIT>
	type <DUNGEON ruin derelict>
	terrain <SPACE>
	dentrance <*GoDown>
	quest_entrance <*ENT_SpaceWreck>
	content <Some 1 30 Sub *DUNGEON_X>
	% Suffocation effect...
	Vacuum
	mapwidth 35
	mapheight 35
	MonkeyMap
	LockedDoorChance 25
	SecretDoorChance 10
	IndustrialTiles

	NeededCells 3

	start <Print 1>
	msg1 <You enter \SCENE SceneID .>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monster>
		type <Fungus Exorg Ruin PreZero>
		SetEnemy 1
		Stat 2 1

		room
		width 3
		height 3
		sub
			Elevator
			Destination -1
		end
	end

Scene
	name <The Crypt of the #>
	requires <*ItemCrypt>
	special <NOEXIT>
	type <DUNGEON crypt>
	dentrance <*GoDown>
	content <Some 1 30 Sub *DUNGEON_X>

	quest_entrance <*ENT_SecretTomb>

	mapwidth 35
	mapheight 35
	MonkeyMap
	LockedDoorChance 25
	SecretDoorChance 10
	RockyTiles

	NeededCells 3

	start <Print 1>
	msg1 <You enter \SCENE SceneID .>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monster>
		type <Vermin Dark PreZero Crypt>
		SetEnemy 1
		Stat 2 1

		room
		width 3
		height 3
		sub
			StairsUp
			Destination -1
		end
	end


%%
%%  *PartyYacht Content
%%
%% There's a party going on. In a yacht.
%% This party will include at least 3 games.

Scene
	name <#'s Yacht>
	requires <*PartyYacht>
	type <Yacht>
	mapwidth 21
	mapheight 21
	ClubMap

	special <NOEXIT>
	quest_entrance <*ENT_PartyYacht>

	NeededCells 5
	Content1 <Some 5 25 Sub *CLUB_X>
	Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 2>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		name <Foyer>
		desig <EntranceGrid>
		Content1 <Variety 3 5 Here *PartyGames %threat%>
		Content3 <Some 3  55 Here *URBAN_X na>

		room
		minimap <#######1###...##...###+##>
		inv
			Elevator
			name <Exit>
			MiniMapComponent 1
			Destination -1
		end
	end

%%
%% *Office Content
%%
%% A place of business.

Scene
	name <# Office>
	requires <*Office>
	type <building>
	mapwidth 22
	mapheight 22
	MallMap

	special <ADDEXIT>
	NeededCells 2
	Content1 <Some 2 80 Sub *SHOP_RANDOM na>
	Content2 <Fill Sub *CORP_PUBLIC>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		name <Foyer>
		desig <EntranceGrid>
		Content <Some 3 50 Here *URBAN_X>
		Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 2>
	end



%%
%%  *ConstructionSite Content
%%
%% A big box-style construction project.

Scene
	name <#'s Workyard>
	requires <*ConstructionSite>
	type <building workshop>
	mapwidth 17
	mapheight 12
	BoxMap
	IndustrialTiles

	special <NOEXIT>

	NeededCells 2
	content <Fill Sub *CONSTRUCTION_X na>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		minimap <.......##...1#...##......>
		inv
			Elevator
			name <Exit>
			MiniMapComponent 1
			Destination -1
		end
	end

Scene
	name <#'s Workyard>
	requires <*ConstructionSite>
	type <building workshop>
	mapwidth 17
	mapheight 17
	BoxMap
	IndustrialTiles

	special <NOEXIT>

	NeededCells 2
	content <Fill Sub *CONSTRUCTION_X na>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		minimap <.......##...1#...##......>
		inv
			Elevator
			name <Exit>
			MiniMapComponent 1
			Destination -1
		end
	end

%%
%%  *Workshop Content
%%
%% A big box-style workshop.

Scene
	name <#'s Workshop>
	requires <*Workshop>
	type <building basement workshop>
	mapwidth 17
	mapheight 12
	BoxMap
	IndustrialTiles

	special <NOEXIT>

	NeededCells 2
	content <Fill Sub *STORAGE_X na>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		minimap <.......##...1#...##......>
		inv
			Elevator
			name <Exit>
			MiniMapComponent 1
			Destination -1
		end
	end

Scene
	name <#'s Workshop>
	requires <*Workshop>
	type <building basement workshop>
	mapwidth 12
	mapheight 12
	BoxMap
	IndustrialTiles

	special <NOEXIT>

	NeededCells 2
	content <Fill Sub *STORAGE_X na>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		minimap <.......##...1#...##......>
		inv
			Elevator
			name <Exit>
			MiniMapComponent 1
			Destination -1
		end
	end

%%
%%  *MicroStation Content
%%
%% A small space station. Just a number of rooms connected by a monkeymap.

Scene
	name <# Station>
	requires <*MicroStation>
	type <asteroid building>
	mapwidth 28
	mapheight 28

	NeededCells 2

	special <NOEXIT>

	MonkeyMap

	Content <Some 1 100 Here *ANTI_ATTACK_SECURITY 2>
	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1 3
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		minimap <......###..#1#...........>
		inv
			Elevator
			name <Airlock>
			MiniMapComponent 1
			Destination -1
		end
	end



%%
%%  *Blank Content
%%
%% A blank scene of the requested type. The calling content had better provide teams and
%% everything else that this scene is going to need, because this prototype comes with
%% nothing.

Scene 0 2
	name <# District>
	requires <*Blank .CityBlock>
	MegaCityMap
	MapWidth 30
	MapHeight 30
	terrain <GROUND>

Scene 0 0
	name <# Basement>
	% An empty basement containing stairs up and that's it.
	requires <*BLANK .Basement>
	type <Basement Private>
	terrain <GROUND>
	special <NOEXIT>

	MonkeyMap
	MapWidth 35
	MapHeight 35
	RockyTiles

	LockedDoorChance 15

	NeededCells 2
	content <Fill Sub *STORAGE_X na>

	sub
		Room
		sub
			StairsUp
			Destination -1
		end
	end

Scene 0 0
	name <# Basement>
	% An empty basement containing stairs up and that's it.
	requires <*BLANK .BoxBasement>
	type <Basement Private>
	terrain <GROUND>
	special <NOEXIT>

	BoxMap
	MapWidth 17
	MapHeight 17
	RockyTiles

	NeededCells 3
	content <Fill Sub *STORAGE_X na>

	sub
		Room
		sub
			StairsUp
			Destination -1
		end
	end


Scene 0 2
	name <# Region>
	requires <*BLANK .Space .Mecha>
	type <Space>
	special <ShowAll>
	terrain <SPACE>

	SpaceMap
	SpaceScroll
	Microgravity
	Vacuum
	SpaceBackdrop

	MapWidth 50
	MapHeight 50

	QUEST_entrance <*ENT_SpaceSecret>

%%
%%  *DestroyBase Content
%%
%% The PC will be facing off against some kind of base, which must be destroyed.
%% Obviously there will be some defenders. May recieve a faction as the base's
%% alliegance.
%%
%% After the encounter, a local variable will be set:
%% if L1=1, the PC won the encounter
%% if L1=2, A win is impossible or the situation has changed

Scene 0 2
	name <# Base>
	requires <*DestroyBase "SPINNER">
	type <Space>
	special <ShowAll>
	terrain <SPACE>

	SpaceMap
	SpaceScroll
	Microgravity
	Vacuum
	SpaceBackdrop

	MapWidth 50
	MapHeight 50

	QUEST_entrance <*ENT_SpaceSecret>

	% V1 = Victory Indicator

	Start <if# %scenefac% 0 if= PCFac %scenefac% Print 2>

	Nu3 <if= T3 0  if= V1 0     Print 1   XPV 100   V= 1 1   PCFEnemy %scenefac%>

	Msg1 <The base has been destroyed!>
	Msg2 <As a member of \FACTION %scenefac% , you are not confronted by the guards.>

	sub
		Team 1
		SetEnemy 2 3

		Team 2
		name <Enemies>
		% If the PC is a member of the base's faction, he can approach it
		% without being stopped.
		Deploy <if= L1 0 if# PCFac 0 else GoRealDeploy if= PCFac %scenefac% else GoRealDeploy>
		GoRealDeploy <SetSelfFaction %scenefac%  WMecha 2 Threat %threat% 200>
		SetEnemy 1

		Team 3
		name <Scenery>
		SetEnemy 1
	end
	inv
		STC Microstation
		SetTeam 3
	end

%%
%% *MechaShowdown Content
%%
%% The PC will face off against a challenger here.
%% The first time the scene is entered the NPC will speak with the PC.
%% After the encounter, a local variable will be set:
%% if L1=1, the PC won the encounter
%% if L1=2, the NPC won the encounter or the situation has changed

Scene 0 2
	name <Encounter with #>
	requires <*MechaShowdown "SPINNER">
	type <Space>
	special <ShowAll>
	terrain <SPACE>

	SpaceMap
	SpaceScroll
	Microgravity
	Vacuum
	SpaceBackdrop

	MapWidth 35
	MapHeight 35

	QUEST_entrance <*ENT_SpaceSecret>

	% V1 = Victory Indicator
	% V2 = Initialization Counter
	start <if= V2 0 ForceChat %scenechar% V= 2 1>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Enemies>
		SetEnemy 1
	end

%%
%% *ExterminationBasement Content
%%
%% The PC is sent to eliminate some monsters from the basement.
%% Monsters show up when %qid% = %id%.
%%
%% After the encounter, a local variable will be set:
%% if L1=1, the PC won the encounter

Scene
	name <# Basement>
	requires <*ExterminationBasement>
	type <Private Basement>
	special <NOEXIT>
	BoxMap
	RockyTiles

	% L1 = Victory Indicator
	% L2 = Initialization Counter

	MapWidth 22
	MapHeight 32

	NeededCells 2
	content <Fill Sub *STORAGE_X na>

	Start <Print 1 if= L2 0 if= QuestStatus %qid% %id% L= 2 1 WMonster 2 %threat%>
	nu2 <if= t2 0 if= L1 0 Print 2 XPV 100 L= 1 1>
	Msg1 <You enter the basement.>
	Msg2 <That seems to be the last of the vermin.>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monsters>
		type <Vermin>
		SetEnemy 1

		Room
		sub
			StairsUp
			Destination -1
		end
	end

Scene
	name <# Basement>
	requires <*ExterminationBasement>
	type <Private Basement>
	special <NOEXIT>
	RockyTiles

	% L1 = Victory Indicator
	% L2 = Initialization Counter

	MonkeyMap
	MapWidth 35
	MapHeight 35

	LockedDoorChance 15
	NeededCells 2
	content <Fill Sub *STORAGE_X na>

	%% Do two monster generations, since this basement is pretty big and they have
	%% a lot of area to fill. Why not do one generation at twice the threat? Because
	%% we don't want to generate out of depth monsters.
	Start <Print 1 if= L2 0 if= QuestStatus %qid% %id% L= 2 1 WMonster 2 %threat% WMonster 2 %threat%>
	nu2 <if= t2 0 if= L1 0 Print 2 XPV 100 L= 1 1>
	Msg1 <You enter the basement.>
	Msg2 <That seems to be the last of the vermin.>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monsters>
		type <Vermin>
		SetEnemy 1

		Room
		FloorType 14
		sub
			StairsUp
			Destination -1
		end
	end

Scene
	name <# Basement>
	requires <*ExterminationBasement (Spinner|Asteroid)>
	type <Private Basement>
	special <NOEXIT>

	% L1 = Victory Indicator
	% L2 = Initialization Counter

	MonkeyMap
	MapWidth 35
	MapHeight 35
	RockyTiles

	LockedDoorChance 15
	NeededCells 2
	content <Fill Sub *STORAGE_X na>

	%% Do two monster generations, since this basement is pretty big and they have
	%% a lot of area to fill. Why not do one generation at twice the threat? Because
	%% we don't want to generate out of depth monsters.
	Start <Print 1 if= L2 0 if= QuestStatus %qid% %id% Print 3 L= 2 1 WMonster 2 %threat% WMonster 2 %threat%>
	nu2 <if= t2 0 if= L1 0 Print 2 XPV 100 L= 1 1>
	Msg1 <You enter the basement.>
	Msg2 <That seems to be the last of the vermin.>
	Msg3 <The air here smells musty.>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monsters>
		type <Vermin Fungus>
		SetEnemy 1

		Room
		sub
			StairsUp
			Destination -1
		end
	end

