%%
%% *:CS_GainAdvantageVsNPC Content
%%
%%  &Reinforcements	The advantage may take the form of reinforcements
%%		.%id%_%plotid%_GoReinforcements
%%  &Decimation		The advantage may take the form of reducing enemy forces
%%		.%id%_%plotid%_GoDecimation
%%
%% The PC may seek advantage against a certain NPC.
%%
%%  If this subplot is won, a trigger associated with the exact advantage
%%  gained should be called. If a nonstandard advantage is gained, no such
%%  trigger need be called.
%%
%% PARAM1: The NPC being opposed
%%

Content
	name <The lance is elsewhere>
	desc <The PC can fight the NPC's lance separately.>
	requires <*:CS_GainAdvantageVsNPC &Decimation>

	% E1 is the NPC being sought
	% E2 is a public scene, needed for NEVERFAIL
	% E3 is a mechanic
	% E4 is an outdoors scene
	% E5 is an encounter where the PC can fight the lance
	Element2 <Scene Public (Garage|Spaceport) !Near -7>
	Element3 <Character Mechanic !Near 2 Neverfail>
	NeverFail3 <Mechanic>
	Element4 <Scene Outdoors !Near -7>
	Element5 <Prefab>
	Place5 <4>

	% P%id%01 = Have revealed encounter

	start <if= p%id%01 0 ifNPCDead %3% LoseSubPlot %plotid%>

	sub
		Persona 3
		rumor%id% <%name3% serviced %name1%'s mecha.>
		% V1 = Info Price
		greeting <if= PlotStatus %plotid% %id% else GoRepair if= p%id%01 0 else GoRepair Goto GoIntro>
		*GoIntro <*IHearYouAreFightingNPC %1% GoExplain>
		GoExplain <v= 1 Threat StoryDL 1 NewChat Say 1 AddChat 1 AddChat 2 AddChat 3>
		*GoRepair <*SERVICE_MECHANIC GoBye>
		*GoBye <*GoodBye>
		result1 <NewChat Say 2 History 3 Cash+ -v1 p= %id%01 1 SetEncounterActive %5%>
		result2 <NewChat Say 4>
		result3 <NewChat Say 5 AddChat 1 AddChat 2 AddChat 4>
		result4 <NewChat Say 6 History 3 p= %id%01 1 SetEncounterActive %5%>
		Msg1 <It just so happens that I know where %name1%'s lancemates are right now. I don't know where \SPR %1% is, but surely fighting \PPR %1% allies separately is worth something. If you want the info it's going to cost $ \VAL v1 .>
		Msg2 <You'll be able to find them in %name4%. It's been a pleasure doing business with you.>
		Msg3 <You learned from %name3% that %name1%'s allies could be found in %name4%.>
		Msg4 <Don't think too long; I can't say how much longer my info is going to be current.>
		Msg5 <If you must know, it's because I repaired their mecha and %name1% ran off without paying the bill. I've got a bit of a score to settle.>
		Msg6 <Good question. I'll get far more satisfaction from seeing %name1% defeated than by recouping my losses... \PPR %1% mecha are supposed to be hanging out in %name4%. Go get them.>
		Prompt1 <It's a deal. [Give money]>
		CPrompt1 <ifG PC$ v1 Accept>
		Prompt2 <I'll think about it.>
		Prompt3 <Why are you telling me this?>
		CPrompt3 <ifInvestigation SkillTar StoryDL Accept>
		Prompt4 <In that case, why are you keeping it a secret?>
		CPrompt4 <ifConversation SkillTar StoryDL Accept>

		MetaScene 5 2
		% This encounter will only be available once; if the PC fails to defeat the
		% henchmen the first time, there will be no second chance.
		MapWidth 30
		MapHeight 30

		% L1 = Encounter Over Counter
		% L2 = Initialization Counter

		Start <if= L2 0 L= 2 1   L= 1 0   Alert 1>
		nu1 <if= T1 0   Return   if= V1 0 V= 1 1   AddRenown -1  LoseSubPlot %plotid%>
		nu2 <if= T2 0   if= V1 0 V= 1 1   Alert 2  History 3     XPV 100   WinSubPlot %plotid%   Trigger0 .%id%_%plotid%_GoDecimation>
		end <SetEncounterInactive %5%>

		Msg1 <You locate some of %name1%'s henchmen.>
		Msg2 <You have defeated the henchmen. %name1%'s forces must now be considerably weakened.>
		Msg3 <You defeated a group of %name1%'s henchmen, weakening \PPR %4% forces.>

		sub
			team 1
			SetEnemy 2
			ParaX 5
			ParaY 5

			team 2
			SetEnemy 1
			Deploy <if= PlotStatus %plotid% %id% SetSelfFaction &EnemyFac   WMecha 2 StoryDL 100>
			ParaX 25
			ParaY 25
		end

	end
	inv
		stc CORE-ACTIVATABLE
		name <%name1%'s Henchmen>
	end

%%
%% *:CS_GainAdvantageVsMecha Content
%%
%%  &Decimation		The advantage may take the form of reducing enemy forces
%%		.%id%_%plotid%_GoDecimation
%%  &Reinforcements	The advantage may take the form of reinforcements
%%		.%id%_%plotid%_GoReinforcements
%%
%%  Before a combat encounter, the PC may be able to gain an advantage
%%  over his enemies. Note that this advantage can be as capricious as you
%%  like- it's not guaranteed to any PC, and may be dependant upon special
%%  skills or reputations.
%%
%%  If this subplot is won, a trigger associated with the exact advantage
%%  gained should be called. If a nonstandard advantage is gained, no such
%%  trigger need be called.

Content
	name <Beaten Gladiator>
	requires <*:GainAdvantageVsMecha &Reinforcements>
	desc <Meet a mercenary who lost to the raiders; may be able to gain his support.>

	% E1 is a garage
	% E2 is the mercenary you can find there
	% E3 is a location for the duel
	Element1 <Scene Public Garage !Near -7>
	Element2 <Prefab>
	Place2 <1 SD ally>
	Element3 <Scene Environs !Near -7>

	% P%id%01 = Initialization Counter
	start <ifNPCDead %2% LoseSubPlot %plotid%>
	update <if= p%id%01 0 p= %id%01 1 NPCLevel %2% StoryDL>

	.%id1%_%plotid1%_GoWin <ifNPCOK %2% else .%id1%_%plotid1%_GoLose  Monologue %2% %id%01  History %id%02  Trigger0 .%id%_%plotid%_GoReinforcements  WinSubPlot %plotid%>
	.%id1%_%plotid1%_GoLose <LoseSubPlot %plotid%>

	Msg%id%01 <You sure showed me. My lancemates will be there to help you fight the raiders.>
	Msg%id%02 <You convinced %name2% to help in the upcoming battle.>

	% SubPlot1 is the duel
	SubPlot1 <*CS_Duel&NoDerailment 2 1 3>

	sub
		Persona 2
		rumor%id% <%name2% was recently defeated by the raiders.>
		greeting <ifSubPlotWon %plotid% else GoCheckOffer NewChat Say %id%01>
		GoCheckOffer <if= PlotStatus %plotid% %id% else GoChat Goto GoGreet>
		*GoGreet <*YouCouldUseHelp GoMakeOffer>
		GoMakeOffer <NewChat Say %id%02 AddCHat %id%01 AddChat %id%02 AddChat %id%03>
		GoChat <NewChat SayAnything>
		result%id%01 <NewChat Say %id%03 LoseSubPlot %plotid%>
		result%id%02 <NewChat Say %id%04 AddChat %id%01 AddChat %id%03>
		result%id%03 <NewChat Say %id%05 AddChat %id%04 AddChat %id%05 AddChat %id%06>
		result%id%04 <NewChat Say %id%06 LoseSubPlot %plotid%>
		result%id%05 <NewChat Say %id%07 AddChat %id%07 AddChat %id%08>
		result%id%06 <NewChat Say %id%08 History %id%09  XPV 100  Trigger0 .%id%_%plotid%_GoReinforcements  WinSubPlot %plotid%>
		result%id%07 <SetPlotStatus %plotid% %id1% Goto .%id%_GoAcceptChallenge>
		*.%id%_GoAcceptChallenge <*IAcceptYourChallenge %3%>
		result%id%08 <NewChat Say %id%10 LoseSubPlot %plotid%>
		Msg%id%01 <My lance will be there to help you out. Me, I gotta buy a new mek.>
		Msg%id%02 <Those raiders you're going up against? I fought them myself a while back, but didn't do so well. Take my advice and stay well clear of them. You'll live longer.>
		Msg%id%03 <You're welcome... though somehow I don't think you're going to be following it.>
		Msg%id%04 <Well, I don't know where you can find them now, if that's what you're talking about...>
		Msg%id%05 <Hold on there. You have no idea how tough these guys are. I seriously doubt that you're strong enough to tip the balance in favor of me and my lance.>
		Msg%id%06 <Good luck with that. If you survive, I'll buy you a drink.>
		Msg%id%07 <You're really serious about this, huh? Well, I'm willing to beat you if you're fool enough to meet me...>
		Msg%id%08 <Yes, I guess it would be... Look, my mecha's still being repaired, but my lancemates are ready to go. When you face the raiders they'll be there at your side.>
		Msg%id%09 <You convinced %name2% to help in the upcoming battle.>
		Msg%id%10 <Good... you're finally learning. Personally, I think I'm going to quit this mercenary racket and get into something safe like accounting or lion taming.>
		Prompt%id%01 <Thanks for the advice.>
		Prompt%id%02 <Do you know where I can find them?>
		Prompt%id%03 <Why don't we team up and defeat them together?>
		Prompt%id%04 <Fine. I'll defeat them by myself.>
		Prompt%id%05 <I'll prove it to you... in a duel!>
		Prompt%id%06 <Maybe not, but wouldn't it be fun to try?>
		CPrompt%id%06 <ifChatNPCSexy ifFlirtation HardSkillTar StoryDL Accept>
		Prompt%id%07 <Let's do it.>
		Prompt%id%08 <Sorry, on second thought it's not such a good idea.>
	end
	inv
		NPC Mercenary
	end


