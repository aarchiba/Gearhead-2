%%
%% Contains a number of unique buildings, usually attached to guaranteed local quests.
%% The key for these scenes should probably be either *[City Desig]_[Something] or
%% *UNIQUE_[Something].

Scene
	name <Theles Spinner Fourth Level>
	requires <*THESP_FourthLevel>
	type <building private>
	special <NOEXIT NORESCUE SOLO UNSAFE>
	PalaceParkTiles

	MapWidth 32
	MapHeight 22
	BoxMap
	Special <NOEXIT SHOWALL>
	FloorType 1

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 3

		team 3
		name <Guards>
		SetAlly 2

		rect
		minimap <......###..#1#...........>
		special <SHAREDPALETTE>
		inv
			Elevator
			MiniMapComponent 1
			Destination -1
			use <if# L2 0 else GoNoElevator  Print 1 Exit Destination>
			GoNoElevator <Print 11>
			Msg11 <This elevator doesn't respond.>
		end

		rect
		minimap <......1#2..###..3#4......>
		special <SHAREDPALETTE>
		inv
			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 1

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 2

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 3

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 4
		end

		rect
		minimap <......1#2..###..3#4......>
		special <SHAREDPALETTE>
		inv
			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 1

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 2

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 3

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 4
		end

		rect
		minimap <......1#2..###..3#4......>
		special <SHAREDPALETTE>
		inv
			STC BIOTANK
			name <Empty Biotank>
			MiniMapComponent 1
			use <if= L3 0 else GoMaybeDie Print 1>
			GoMaybeDie <ifYesNo 2 3 4 else GoDontDie Alert 5 Alert 6 History 8 KillPC>
			GoDontDie <Print 7>
			Msg1 <This tank appears to be empty.>
			Msg2 <You find the empty tank that the gardener mentioned.>
			Msg3 <Enter the container.>
			Msg4 <Don't do it.>
			Msg5 <You climb inside the biotank and close the door. Relaxing music begins to play as a pleasantly smelling gas fills the chamber.>
			Msg6 <You drift into a strange dream from which you never awaken.>
			Msg7 <You leave it alone.>
			Msg8 <You became part of the collective consciousness which runs Theles Spinner.>

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 2

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 3

			STC BIOTANK
			use <Print 1>
			Msg1 <This tank contains a human being floating in a foetal position.>
			MiniMapComponent 4
		end

		forest

		forest

		forest

		forest

		forest

		lake

		lake
	end


Scene
	name <# Spire>
	requires <*THESP_FinalSpire>
	special <SOLO NOEXIT NORESCUE>
	type <DUNGEON Industrial>
	dentrance <*GoUp>
	mapwidth 40
	mapheight 40
	MonkeyMap
	LockedDoorChance 5
	SecretDoorChance 15
	IndustrialTiles

	NeededCells 3

	start <Print 1>
	msg1 <You enter \SCENE SceneID .>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monster>
		type <Robot Vermin>
		SetEnemy 1
		Stat 2 1

		room
		width 3
		height 3
		sub
			StairsDown
			Destination -1
		end
	end

Scene
	name <Theles Spinner Third Level>
	requires <*THESP_ThirdLevel>
	type <building private>
	map <MAP_Theles3F.txt>
	special <NOEXIT UNREGULATED NORESCUE SOLO UNSAFE>
	Tolerance 15

	% L1 = If nonzero, this level may be exited.

	Start <Print 1>
	Msg1 <You enter the Theles Spinner third level.>
	5Min <ifTeamHostile 3 MonsterUp 3 d10>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 3
		Passive

		team 3
		name <Guards>
		type <ROBOT>
		SetAlly 2
		Stat 2 50

		room
		name <Foyer>
		desig <EntranceGrid>
		Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 3>
	end
	inv
		Elevator
		use <if# L1 0 else GoNoElevator  Print 1 Exit Destination>
		GoNoElevator <Print 11>
		Msg11 <This elevator doesn't respond.>
		Destination -1
		XPos 2
		YPos 9

		STC ELEVATOR_TO_NOWHERE
		XPos 3
		YPos 3

		STC ELEVATOR_TO_NOWHERE
		XPos 3
		YPos 16

		STC ELEVATOR_TO_NOWHERE
		XPos 36
		YPos 4

		STC ONESHOTDOOR
		update <if# L2 0 SetStat STAT_Lock 0>
		XPos 30
		YPos 14
		Lock 14
	end


Scene
	name <Population Control>
	requires <*THESP_Population>
	type <building private>
	mapwidth 15
	mapheight 15
	MallMap

	special <ADDEXIT UNREGULATED>
	Tolerance 10

	Start <Print 1>
	Msg1 <You enter the Theles Industrial Control Center.>

	NeededCells 2

	Content2 <Fill Sub *HOSPITAL_X>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		name <Foyer>
		desig <EntranceGrid>
		Content <Some 2 50 Here *URBAN_X>
		Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 3>
	end

Scene
	name <Theles Industrial>
	requires <*THESP_Industrial>
	type <building private>
	mapwidth 15
	mapheight 15
	MallMap

	special <ADDEXIT UNREGULATED>
	Tolerance 10

	Start <Print 1>
	Msg1 <You enter the Theles Industrial Control Center.>

	NeededCells 2
	Content3 <Some 1 100 Sub *MECHANIC_SHOP   na>
	Content6 <Some 1 100 Sub *MECHA_SHOP      na>
	Content9 <Fill Sub *SHOP_RANDOM           na>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		name <Foyer>
		desig <EntranceGrid>
		Content <Some 2 50 Here *URBAN_X>
		Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 3>
	end

Scene
	name <Second Tier Armory>
	requires <*THESP_Armory>
	type <building private>
	mapwidth 15
	mapheight 15
	MallMap

	special <ADDEXIT UNREGULATED>
	Tolerance 10

	Start <Print 1>
	Msg1 <You enter the Second Tier Armory.>

	NeededCells 2
	Content3 <Some 1 100 Sub *WEAPON_SHOP     na>
	Content4 <Some 1 100 Sub *ARMOR_SHOP      na>
	Content9 <Fill Sub *SHOP_RANDOM           na>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		name <Foyer>
		desig <EntranceGrid>
		Content <Some 2 50 Here *URBAN_X>
		Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 3>
	end

Scene
	name <Ascension Complex>
	requires <*THESP_AscensionComplex>
	type <building private>
	mapwidth 15
	mapheight 15
	MallMap

	special <ADDEXIT>

	Start <Print 1>
	Msg1 <You enter the Ascension Complex.>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		name <Foyer>
		desig <EntranceGrid>
		Content <Some 1 20 Here *URBAN_X>
		Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 3>
	end

Scene
	name <# Spire>
	requires <*THESP_IndustrialSpire>
	special <NOEXIT NORESCUE>
	type <DUNGEON Industrial>
	dentrance <*GoUp>
	content <Some 1 10 Sub *DUNGEON_X>
	mapwidth 35
	mapheight 35
	MonkeyMap
	LockedDoorChance 30
	SecretDoorChance 5
	IndustrialTiles

	NeededCells 3

	start <Print 1>
	msg1 <You enter \SCENE SceneID .>

	sub
		Team 1
		SetEnemy 2

		Team 2
		name <Monster>
		type <Robot Vermin>
		SetEnemy 1
		Stat 2 1

		room
		width 3
		height 3
		sub
			StairsDown
			Destination -1
		end
	end

Scene 0 3
	name <Theles Spinner Second Level>
	requires <*THESP_SecondLevel>
	type <Private>
	MegaCityMap
	MapWidth 15
	MapHeight 8

	Start <Print 1>
	Msg1 <You enter the Theles Spinner second layer.>


Scene
	name <Theles Control Office>
	requires <*THESP_FirstRung>
	type <building public>
	mapwidth 15
	mapheight 15
	MallMap

	special <ADDEXIT>
	NeededCells 2
	content <Some 2 70 Sub *GOV_MILITARY na>

	sub
		team 1

		team 2
		name <Citizens>
		SetAlly 1
		Passive

		team 3
		name <Guards>
		SetAlly 2

		room
		name <Foyer>
		desig <EntranceGrid>
		Content <Some 3 50 Here *URBAN_X>
		Content2 <Some 1 100 Here *ANTI_ATTACK_SECURITY 3>
	end

